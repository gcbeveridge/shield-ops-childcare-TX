<div id="add-medication" class="modal">
    <div class="modal-content" style="max-width: 700px;">
        <div class="modal-header">
            <h2 class="modal-title">New Medication Authorization üíä</h2>
            <p style="font-size: 14px; color: var(--gray-700); margin-top: 8px;">Texas ¬ß744.2653 - Parent
                authorization required</p>
        </div>
        <form id="add-medication-form" onsubmit="addMedication(event)">
            <div class="form-group">
                <label class="form-label">Child Name</label>
                <input id="med-child-name" type="text" class="form-input" placeholder="Select child..." required>
            </div>
            <div class="form-group">
                <label class="form-label">Medication Name</label>
                <input id="med-name" type="text" class="form-input" placeholder="e.g., Amoxicillin, Albuterol" required>
            </div>
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 16px;">
                <div class="form-group">
                    <label class="form-label">Type</label>
                    <select id="med-type" class="form-input" required>
                        <option value="prescription">Prescription</option>
                        <option value="otc">Non-Prescription (OTC)</option>
                        <option value="emergency">Emergency (EpiPen, Inhaler)</option>
                    </select>
                </div>
                <div class="form-group">
                    <label class="form-label">Dosage</label>
                    <input id="med-dosage" type="text" class="form-input" placeholder="e.g., 5 mL, 10 mg, 2 puffs"
                        required>
                </div>
            </div>
            <div class="form-group">
                <label class="form-label">Administration Schedule</label>
                <select id="med-schedule" class="form-input" required>
                    <option>Scheduled Daily (specific time)</option>
                    <option>Multiple Times Per Day</option>
                    <option>As Needed (PRN)</option>
                    <option>Emergency Only</option>
                </select>
            </div>
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 16px;">
                <div class="form-group">
                    <label class="form-label">Start Date</label>
                    <input id="med-start-date" type="date" class="form-input" required>
                </div>
                <div class="form-group">
                    <label class="form-label">End Date / Authorization Expiration</label>
                    <input id="med-end-date" type="date" class="form-input" required>
                </div>
            </div>
            <div class="form-group">
                <label class="form-label">Special Instructions / Conditions</label>
                <textarea id="med-instructions" class="form-input" rows="2"
                    placeholder="e.g., Give with food, monitor for side effects..."></textarea>
            </div>
            <div style="background: var(--gray-50); padding: 16px; border-radius: 8px; margin-top: 16px;">
                <strong style="font-size: 13px; display: block; margin-bottom: 8px;">‚úì Texas Requirements
                    Checklist:</strong>
                <div style="font-size: 12px; color: var(--gray-700); line-height: 1.8;">
                    ‚Ä¢ Parent written/electronic authorization (¬ß744.2653)<br>
                    ‚Ä¢ Original container with child's name and date<br>
                    ‚Ä¢ Cannot exceed label instructions or doctor's orders<br>
                    ‚Ä¢ Authorization expires after 1 year<br>
                    ‚Ä¢ Medication must not be expired
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" onclick="closeModal('add-medication')">Cancel</button>
                <button id="add-medication-btn" type="submit" class="btn btn-primary">Save Medication
                    Authorization</button>
            </div>
        </form>
    </div>
</div>

<!-- Administer Medication Modal -->
<!-- Upload Document Modal (4-Step Enhanced) -->
<div id="upload-document" class="modal">
    <div class="modal-content" style="max-width: 600px;">
        <div class="modal-header">
            <h2 class="modal-title">Upload Document üìÅ</h2>
            <div style="display: flex; gap: 8px; margin-top: 12px; font-size: 12px;">
                <div id="step-indicator-1"
                    style="flex: 1; padding: 4px; background: var(--primary); color: white; text-align: center; border-radius: 4px;">
                    1. Basic Info</div>
                <div id="step-indicator-2"
                    style="flex: 1; padding: 4px; background: var(--gray-200); color: var(--gray-600); text-align: center; border-radius: 4px;">
                    2. Dates</div>
                <div id="step-indicator-3"
                    style="flex: 1; padding: 4px; background: var(--gray-200); color: var(--gray-600); text-align: center; border-radius: 4px;">
                    3. Upload</div>
                <div id="step-indicator-4"
                    style="flex: 1; padding: 4px; background: var(--gray-200); color: var(--gray-600); text-align: center; border-radius: 4px;">
                    4. Review</div>
            </div>
        </div>
        <form>
            <!-- Step 1: Basic Information -->
            <div id="upload-step-1" class="upload-step">
                <div class="form-group">
                    <label class="form-label">Document Name</label>
                    <input type="text" id="upload-doc-name" class="form-input" placeholder="e.g., CPR Certification"
                        required>
                </div>
                <div class="form-group">
                    <label class="form-label">Form Number</label>
                    <select id="upload-form-number" class="form-input" required>
                        <option value="">Select a form...</option>
                        <option value="2910">Form 2910 - Application for License</option>
                        <option value="2948">Form 2948 - Plan of Operation</option>
                        <option value="2971">Form 2971 - Background Check Request</option>
                        <option value="2985">Form 2985 - Employment Affidavit</option>
                        <option value="7239">Form 7239 - Incident/Illness Report</option>
                        <option value="7243">Form 7243 - Emergency Phone Numbers</option>
                        <option value="7250">Form 7250 - Staff Training Record</option>
                        <option value="7255">Form 7255 - Medication Authorization</option>
                        <option value="7259">Form 7259 - Personnel Records Evaluation</option>
                        <option value="7260">Form 7260 - Children's Records Evaluation</option>
                        <option value="7263">Form 7263 - Emergency Practices</option>
                        <option value="other">Other (free text)</option>
                    </select>
                </div>
                <div class="form-group">
                    <label class="form-label">Category</label>
                    <select id="upload-category" class="form-input" required>
                        <option value="">Select category...</option>
                        <option value="licensing">Licensing & Permits</option>
                        <option value="staff">Staff Records</option>
                        <option value="children">Children</option>
                        <option value="health">Health & Safety</option>
                        <option value="facility">Facility & Inspections</option>
                        <option value="insurance">Insurance</option>
                    </select>
                </div>
                <div class="form-group">
                    <label class="form-label">Violation Weight</label>
                    <select id="upload-violation" class="form-input" required>
                        <option value="">Select weight...</option>
                        <option value="high">High</option>
                        <option value="med-high">Medium-High</option>
                        <option value="medium">Medium</option>
                        <option value="med-low">Medium-Low</option>
                        <option value="low">Low</option>
                    </select>
                </div>
            </div>

            <!-- Step 2: Dates & Association -->
            <div id="upload-step-2" class="upload-step" style="display: none;">
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 16px;">
                    <div class="form-group">
                        <label class="form-label">Issue Date</label>
                        <input type="date" id="upload-issue-date" class="form-input" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Expiration Date</label>
                        <input type="date" id="upload-exp-date" class="form-input">
                    </div>
                </div>
                <div class="form-group">
                    <label style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
                        <input type="checkbox" id="upload-no-exp" onchange="toggleExpirationDate()">
                        <span class="form-label" style="margin: 0;">No expiration date</span>
                    </label>
                </div>
                <div class="form-group">
                    <label class="form-label">Associated With</label>
                    <select id="upload-associated" class="form-input" required>
                        <option value="">Select association...</option>
                        <option value="facility">Facility-wide</option>
                        <option value="emily">Emily Rodriguez (Staff)</option>
                        <option value="david">David Martinez (Staff)</option>
                        <option value="sarah">Sarah Johnson (Staff)</option>
                        <option value="lisa">Lisa Thompson (Staff)</option>
                        <option value="emma">Emma S. (Child)</option>
                        <option value="other-child">Other Child...</option>
                    </select>
                </div>
                <div class="form-group">
                    <label class="form-label">Owner/Subject</label>
                    <input type="text" id="upload-owner" class="form-input" placeholder="Auto-filled based on selection"
                        required>
                </div>
            </div>

            <!-- Step 3: File Upload -->
            <div id="upload-step-3" class="upload-step" style="display: none;">
                <div class="form-group">
                    <label class="form-label">Upload File</label>
                    <input type="file" id="upload-file-input" accept=".pdf,.jpg,.jpeg,.png,.docx,.doc"
                        style="display: none;" onchange="handleFileSelect(event)">
                    <div id="upload-dropzone"
                        style="border: 2px dashed var(--gray-300); border-radius: 8px; padding: 48px; text-align: center; cursor: pointer; transition: all var(--transition-base);"
                        onclick="document.getElementById('upload-file-input').click()"
                        ondragover="handleDragOver(event)" ondrop="handleFileDrop(event)"
                        ondragleave="handleDragLeave(event)">
                        <div style="font-size: 48px; margin-bottom: 12px;">üìÑ</div>
                        <div style="font-size: 14px; color: var(--gray-900); margin-bottom: 4px; font-weight: 600;">
                            Click to upload or drag & drop</div>
                        <div style="font-size: 12px; color: var(--gray-600);">PDF, JPG, PNG, DOCX (Max 10MB)</div>
                    </div>
                </div>
                <div id="upload-preview"
                    style="display: none; margin-top: 16px; padding: 16px; background: var(--gray-50); border-radius: 8px; border: 1px solid var(--gray-200);">
                    <div style="display: flex; align-items: center; gap: 12px;">
                        <div id="file-icon" style="font-size: 32px;">üìÑ</div>
                        <div style="flex: 1;">
                            <div id="file-name" style="font-size: 14px; font-weight: 600; color: var(--gray-900);">
                                filename.pdf</div>
                            <div id="file-size" style="font-size: 12px; color: var(--gray-600);">2.5 MB</div>
                        </div>
                        <button type="button" onclick="removeSelectedFile()"
                            style="padding: 6px 12px; font-size: 12px; background: var(--danger); color: white; border: none; border-radius: 4px; cursor: pointer; transition: opacity 0.2s;"
                            onmouseover="this.style.opacity='0.8'" onmouseout="this.style.opacity='1'">Remove</button>
                    </div>
                    <div id="upload-progress-container" style="display: none; margin-top: 12px;">
                        <div
                            style="display: flex; justify-content: space-between; font-size: 12px; margin-bottom: 4px;">
                            <span style="color: var(--gray-700);">Uploading...</span>
                            <span id="upload-percentage" style="color: var(--primary); font-weight: 600;">0%</span>
                        </div>
                        <div
                            style="width: 100%; height: 6px; background: var(--gray-200); border-radius: 3px; overflow: hidden;">
                            <div id="upload-progress-bar"
                                style="width: 0%; height: 100%; background: linear-gradient(90deg, var(--primary), var(--success)); transition: width 0.3s;">
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Step 4: Review & Confirm -->
            <div id="upload-step-4" class="upload-step" style="display: none;">
                <div style="background: var(--gray-50); border-radius: 8px; padding: 20px;">
                    <h3 style="font-size: 16px; font-weight: 600; margin-bottom: 16px; color: var(--gray-900);">Does
                        this look correct?</h3>
                    <div style="display: grid; gap: 12px;">
                        <div style="display: grid; grid-template-columns: 140px 1fr; gap: 8px;">
                            <div style="font-size: 13px; color: var(--gray-600);">Document Name:</div>
                            <div id="review-doc-name"
                                style="font-size: 13px; font-weight: 600; color: var(--gray-900);">‚Äî</div>
                        </div>
                        <div style="display: grid; grid-template-columns: 140px 1fr; gap: 8px;">
                            <div style="font-size: 13px; color: var(--gray-600);">Form Number:</div>
                            <div id="review-form-number"
                                style="font-size: 13px; font-weight: 600; color: var(--gray-900);">‚Äî</div>
                        </div>
                        <div style="display: grid; grid-template-columns: 140px 1fr; gap: 8px;">
                            <div style="font-size: 13px; color: var(--gray-600);">Category:</div>
                            <div id="review-category"
                                style="font-size: 13px; font-weight: 600; color: var(--gray-900);">‚Äî</div>
                        </div>
                        <div style="display: grid; grid-template-columns: 140px 1fr; gap: 8px;">
                            <div style="font-size: 13px; color: var(--gray-600);">Violation Weight:</div>
                            <div id="review-violation"
                                style="font-size: 13px; font-weight: 600; color: var(--gray-900);">‚Äî</div>
                        </div>
                        <div style="display: grid; grid-template-columns: 140px 1fr; gap: 8px;">
                            <div style="font-size: 13px; color: var(--gray-600);">Issue Date:</div>
                            <div id="review-issue-date"
                                style="font-size: 13px; font-weight: 600; color: var(--gray-900);">‚Äî</div>
                        </div>
                        <div style="display: grid; grid-template-columns: 140px 1fr; gap: 8px;">
                            <div style="font-size: 13px; color: var(--gray-600);">Expiration Date:</div>
                            <div id="review-exp-date"
                                style="font-size: 13px; font-weight: 600; color: var(--gray-900);">‚Äî</div>
                        </div>
                        <div style="display: grid; grid-template-columns: 140px 1fr; gap: 8px;">
                            <div style="font-size: 13px; color: var(--gray-600);">Associated With:</div>
                            <div id="review-associated"
                                style="font-size: 13px; font-weight: 600; color: var(--gray-900);">‚Äî</div>
                        </div>
                        <div style="display: grid; grid-template-columns: 140px 1fr; gap: 8px;">
                            <div style="font-size: 13px; color: var(--gray-600);">Owner/Subject:</div>
                            <div id="review-owner" style="font-size: 13px; font-weight: 600; color: var(--gray-900);">‚Äî
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="modal-footer" style="margin-top: 24px;">
                <button type="button" class="btn btn-secondary" onclick="closeModal('upload-document')">Cancel</button>
                <button type="button" id="upload-prev-btn" class="btn btn-secondary" style="display: none;"
                    onclick="previousUploadStep()">‚Üê Previous</button>
                <button type="button" id="upload-next-btn" class="btn btn-primary" onclick="nextUploadStep()">Next
                    ‚Üí</button>
                <button type="button" id="upload-save-btn" class="btn btn-primary" style="display: none;"
                    onclick="saveDocument()">Save Document</button>
            </div>
        </form>
    </div>
</div>

<!-- Missing Required Forms Modal -->
<div id="missing-forms" class="modal">
    <div class="modal-content" style="max-width: 700px;">
        <div class="modal-header">
            <h2 class="modal-title">Missing Required Documents</h2>
            <p style="font-size: 14px; color: var(--gray-600); margin-top: 8px;">Bright Futures Learning Center</p>
        </div>
        <div style="display: flex; flex-direction: column; gap: 24px;">
            <!-- Licensing & Permits -->
            <div>
                <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 12px;">
                    <input type="checkbox" style="width: 16px; height: 16px;">
                    <h3 style="font-size: 16px; font-weight: 600; color: var(--gray-900);">LICENSING & PERMITS (2
                        missing)</h3>
                </div>
                <div style="display: flex; flex-direction: column; gap: 8px; margin-left: 24px;">
                    <div
                        style="display: flex; justify-content: space-between; align-items: center; padding: 12px; background: var(--gray-50); border-radius: 6px;">
                        <div>
                            <input type="checkbox" style="margin-right: 8px;">
                            <span style="font-size: 14px; color: var(--gray-900);">Form 2910 - Application for
                                License</span>
                        </div>
                        <button class="btn-small btn-primary-small"
                            onclick="openModal('upload-document'); closeModal('missing-forms');">+ Add
                            Document</button>
                    </div>
                    <div
                        style="display: flex; justify-content: space-between; align-items: center; padding: 12px; background: var(--gray-50); border-radius: 6px;">
                        <div>
                            <input type="checkbox" style="margin-right: 8px;">
                            <span style="font-size: 14px; color: var(--gray-900);">Current License (MUST BE
                                POSTED)</span>
                            <span class="badge"
                                style="background: var(--danger); color: white; font-size: 10px; padding: 2px 6px; margin-left: 8px;">CRITICAL</span>
                        </div>
                        <button class="btn-small btn-primary-small"
                            onclick="openModal('upload-document'); closeModal('missing-forms');">+ Add
                            Document</button>
                    </div>
                </div>
            </div>

            <!-- Staff Records -->
            <div>
                <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 12px;">
                    <input type="checkbox" style="width: 16px; height: 16px;">
                    <h3 style="font-size: 16px; font-weight: 600; color: var(--gray-900);">STAFF RECORDS (5 missing)
                    </h3>
                </div>
                <div style="display: flex; flex-direction: column; gap: 8px; margin-left: 24px;">
                    <div
                        style="display: flex; justify-content: space-between; align-items: center; padding: 12px; background: var(--gray-50); border-radius: 6px;">
                        <div>
                            <input type="checkbox" style="margin-right: 8px;">
                            <span style="font-size: 14px; color: var(--gray-900);">Form 2971 - Background Check
                                (Sarah Johnson)</span>
                        </div>
                        <button class="btn-small btn-primary-small"
                            onclick="openModal('upload-document'); closeModal('missing-forms');">+ Add
                            Document</button>
                    </div>
                    <div
                        style="display: flex; justify-content: space-between; align-items: center; padding: 12px; background: var(--gray-50); border-radius: 6px;">
                        <div>
                            <input type="checkbox" style="margin-right: 8px;">
                            <span style="font-size: 14px; color: var(--gray-900);">Form 2985 - Employment Affidavit
                                (Mike Chen)</span>
                        </div>
                        <button class="btn-small btn-primary-small"
                            onclick="openModal('upload-document'); closeModal('missing-forms');">+ Add
                            Document</button>
                    </div>
                    <div
                        style="display: flex; justify-content: space-between; align-items: center; padding: 12px; background: var(--gray-50); border-radius: 6px;">
                        <div>
                            <input type="checkbox" style="margin-right: 8px;">
                            <span style="font-size: 14px; color: var(--gray-900);">CPR Certification (John
                                Doe)</span>
                        </div>
                        <button class="btn-small btn-primary-small"
                            onclick="openModal('upload-document'); closeModal('missing-forms');">+ Add
                            Document</button>
                    </div>
                    <div
                        style="display: flex; justify-content: space-between; align-items: center; padding: 12px; background: var(--gray-50); border-radius: 6px;">
                        <div>
                            <input type="checkbox" style="margin-right: 8px;">
                            <span style="font-size: 14px; color: var(--gray-900);">Form 7250 - Staff Training Record
                                (New Hire)</span>
                        </div>
                        <button class="btn-small btn-primary-small"
                            onclick="openModal('upload-document'); closeModal('missing-forms');">+ Add
                            Document</button>
                    </div>
                    <div
                        style="display: flex; justify-content: space-between; align-items: center; padding: 12px; background: var(--gray-50); border-radius: 6px;">
                        <div>
                            <input type="checkbox" style="margin-right: 8px;">
                            <span style="font-size: 14px; color: var(--gray-900);">TB Test Results (Multiple
                                Staff)</span>
                        </div>
                        <button class="btn-small btn-primary-small"
                            onclick="openModal('upload-document'); closeModal('missing-forms');">+ Add
                            Document</button>
                    </div>
                </div>
            </div>

            <!-- Facility & Inspections -->
            <div>
                <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 12px;">
                    <input type="checkbox" style="width: 16px; height: 16px;">
                    <h3 style="font-size: 16px; font-weight: 600; color: var(--gray-900);">FACILITY & INSPECTIONS (3
                        missing)</h3>
                </div>
                <div style="display: flex; flex-direction: column; gap: 8px; margin-left: 24px;">
                    <div
                        style="display: flex; justify-content: space-between; align-items: center; padding: 12px; background: var(--gray-50); border-radius: 6px;">
                        <div>
                            <input type="checkbox" style="margin-right: 8px;">
                            <span style="font-size: 14px; color: var(--gray-900);">Fire Inspection Report (Annual -
                                Overdue)</span>
                            <span class="badge"
                                style="background: var(--danger); color: white; font-size: 10px; padding: 2px 6px; margin-left: 8px;">OVERDUE</span>
                        </div>
                        <button class="btn-small btn-primary-small"
                            onclick="openModal('upload-document'); closeModal('missing-forms');">+ Add
                            Document</button>
                    </div>
                    <div
                        style="display: flex; justify-content: space-between; align-items: center; padding: 12px; background: var(--gray-50); border-radius: 6px;">
                        <div>
                            <input type="checkbox" style="margin-right: 8px;">
                            <span style="font-size: 14px; color: var(--gray-900);">Sanitation Inspection
                                Report</span>
                        </div>
                        <button class="btn-small btn-primary-small"
                            onclick="openModal('upload-document'); closeModal('missing-forms');">+ Add
                            Document</button>
                    </div>
                    <div
                        style="display: flex; justify-content: space-between; align-items: center; padding: 12px; background: var(--gray-50); border-radius: 6px;">
                        <div>
                            <input type="checkbox" style="margin-right: 8px;">
                            <span style="font-size: 14px; color: var(--gray-900);">Playground Equipment
                                Certification</span>
                        </div>
                        <button class="btn-small btn-primary-small"
                            onclick="openModal('upload-document'); closeModal('missing-forms');">+ Add
                            Document</button>
                    </div>
                </div>
            </div>

            <!-- Children -->
            <div>
                <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 12px;">
                    <input type="checkbox" style="width: 16px; height: 16px;">
                    <h3 style="font-size: 16px; font-weight: 600; color: var(--gray-900);">CHILDREN (2 missing)</h3>
                </div>
                <div style="display: flex; flex-direction: column; gap: 8px; margin-left: 24px;">
                    <div
                        style="display: flex; justify-content: space-between; align-items: center; padding: 12px; background: var(--gray-50); border-radius: 6px;">
                        <div>
                            <input type="checkbox" style="margin-right: 8px;">
                            <span style="font-size: 14px; color: var(--gray-900);">Enrollment Form (New Child -
                                Started Monday)</span>
                        </div>
                        <button class="btn-small btn-primary-small"
                            onclick="openModal('upload-document'); closeModal('missing-forms');">+ Add
                            Document</button>
                    </div>
                    <div
                        style="display: flex; justify-content: space-between; align-items: center; padding: 12px; background: var(--gray-50); border-radius: 6px;">
                        <div>
                            <input type="checkbox" style="margin-right: 8px;">
                            <span style="font-size: 14px; color: var(--gray-900);">Medical Emergency Authorization
                                (Tommy L.)</span>
                        </div>
                        <button class="btn-small btn-primary-small"
                            onclick="openModal('upload-document'); closeModal('missing-forms');">+ Add
                            Document</button>
                    </div>
                </div>
            </div>
        </div>
        <div class="modal-footer" style="margin-top: 24px;">
            <button type="button" class="btn btn-secondary" onclick="closeModal('missing-forms')">Close</button>
            <button type="button" class="btn btn-primary">Print Checklist</button>
        </div>
    </div>
</div>

<!-- Inspection Readiness Report Modal -->
<div id="inspection-readiness" class="modal">
    <div class="modal-content" style="max-width: 800px;">
        <div class="modal-header">
            <h2 class="modal-title">üìä Inspection Readiness Report</h2>
            <div style="display: flex; justify-content: space-between; margin-top: 12px;">
                <p style="font-size: 14px; color: var(--gray-600);">Generated: October 6, 2025 at 3:45 PM</p>
                <p style="font-size: 14px; color: var(--gray-600);">Facility: Bright Futures Learning Center</p>
            </div>
        </div>

        <div style="display: flex; flex-direction: column; gap: 20px;">
            <!-- Overall Compliance Score -->
            <div
                style="padding: 24px; background: linear-gradient(135deg, rgba(245, 158, 11, 0.1), rgba(245, 158, 11, 0.05)); border-radius: 12px; text-align: center;">
                <div style="font-size: 48px; font-weight: 800; color: var(--warning); margin-bottom: 8px;">87%</div>
                <div style="font-size: 16px; font-weight: 600; color: var(--gray-900); margin-bottom: 4px;">OVERALL
                    COMPLIANCE SCORE</div>
                <div
                    style="display: inline-block; padding: 6px 16px; background: var(--warning); color: white; border-radius: 20px; font-size: 14px; font-weight: 600;">
                    CAUTION</div>
                <p style="font-size: 13px; color: var(--gray-600); margin-top: 12px;">Address missing items before
                    inspection</p>
            </div>

            <!-- Licensing & Permits -->
            <div style="border: 1px solid var(--gray-200); border-radius: 8px; padding: 16px;">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px;">
                    <h3 style="font-size: 16px; font-weight: 600; color: var(--gray-900);">‚úÖ LICENSING & PERMITS
                    </h3>
                    <div style="display: flex; align-items: center; gap: 8px;">
                        <span style="font-size: 14px; color: var(--gray-600);">10/12 Complete</span>
                        <span style="font-size: 18px; font-weight: 700; color: #f59e0b;">83%</span>
                    </div>
                </div>
                <div
                    style="width: 100%; height: 8px; background: var(--gray-200); border-radius: 4px; overflow: hidden; margin-bottom: 12px;">
                    <div style="width: 83%; height: 100%; background: linear-gradient(90deg, #f59e0b, #eab308);">
                    </div>
                </div>
                <div style="font-size: 13px; color: var(--gray-700);">
                    ‚úÖ Current License - Posted<br>
                    ‚úÖ Form 2910 - Application<br>
                    ‚úÖ Director's Certificate - Current<br>
                    ‚ùå MISSING: Form 2948 - Plan of Operation<br>
                    ‚ùå MISSING: Permit renewal documentation
                </div>
            </div>

            <!-- Staff Records -->
            <div style="border: 1px solid var(--gray-200); border-radius: 8px; padding: 16px;">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px;">
                    <h3 style="font-size: 16px; font-weight: 600; color: var(--gray-900);">‚úÖ STAFF RECORDS</h3>
                    <div style="display: flex; align-items: center; gap: 8px;">
                        <span style="font-size: 14px; color: var(--gray-600);">40/45 Complete</span>
                        <span style="font-size: 18px; font-weight: 700; color: #10b981;">89%</span>
                    </div>
                </div>
                <div
                    style="width: 100%; height: 8px; background: var(--gray-200); border-radius: 4px; overflow: hidden; margin-bottom: 12px;">
                    <div style="width: 89%; height: 100%; background: linear-gradient(90deg, #10b981, #059669);">
                    </div>
                </div>
                <div style="font-size: 13px; color: var(--gray-700);">
                    ‚úÖ Background Checks (15/15)<br>
                    ‚ö†Ô∏è CPR Certifications (12/15) - 3 expired<br>
                    ‚úÖ Training Records (13/15) - 2 incomplete
                </div>
            </div>

            <!-- Health & Safety -->
            <div style="border: 1px solid var(--gray-200); border-radius: 8px; padding: 16px;">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px;">
                    <h3 style="font-size: 16px; font-weight: 600; color: var(--gray-900);">‚úÖ HEALTH & SAFETY</h3>
                    <div style="display: flex; align-items: center; gap: 8px;">
                        <span style="font-size: 14px; color: var(--gray-600);">8/10 Complete</span>
                        <span style="font-size: 18px; font-weight: 700; color: #10b981;">80%</span>
                    </div>
                </div>
                <div
                    style="width: 100%; height: 8px; background: var(--gray-200); border-radius: 4px; overflow: hidden; margin-bottom: 12px;">
                    <div style="width: 80%; height: 100%; background: linear-gradient(90deg, #10b981, #059669);">
                    </div>
                </div>
                <div style="font-size: 13px; color: var(--gray-700);">
                    ‚úÖ Health Inspections Current<br>
                    ‚ö†Ô∏è Food Handler Permits - 1 expired<br>
                    ‚úÖ Emergency Procedures Posted
                </div>
            </div>

            <!-- Facility & Inspections -->
            <div style="border: 1px solid var(--gray-200); border-radius: 8px; padding: 16px;">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px;">
                    <h3 style="font-size: 16px; font-weight: 600; color: var(--gray-900);">‚úÖ FACILITY & INSPECTIONS
                    </h3>
                    <div style="display: flex; align-items: center; gap: 8px;">
                        <span style="font-size: 14px; color: var(--gray-600);">12/15 Complete</span>
                        <span style="font-size: 18px; font-weight: 700; color: #10b981;">80%</span>
                    </div>
                </div>
                <div
                    style="width: 100%; height: 8px; background: var(--gray-200); border-radius: 4px; overflow: hidden; margin-bottom: 12px;">
                    <div style="width: 80%; height: 100%; background: linear-gradient(90deg, #10b981, #059669);">
                    </div>
                </div>
                <div style="font-size: 13px; color: var(--gray-700);">
                    ‚úÖ Building Safety Current<br>
                    ‚ùå Fire Inspection Overdue<br>
                    ‚úÖ Sanitation Report Current
                </div>
            </div>

            <!-- Children -->
            <div style="border: 1px solid var(--gray-200); border-radius: 8px; padding: 16px;">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px;">
                    <h3 style="font-size: 16px; font-weight: 600; color: var(--gray-900);">‚úÖ CHILDREN</h3>
                    <div style="display: flex; align-items: center; gap: 8px;">
                        <span style="font-size: 14px; color: var(--gray-600);">24/26 Complete</span>
                        <span style="font-size: 18px; font-weight: 700; color: #10b981;">92%</span>
                    </div>
                </div>
                <div
                    style="width: 100%; height: 8px; background: var(--gray-200); border-radius: 4px; overflow: hidden; margin-bottom: 12px;">
                    <div style="width: 92%; height: 100%; background: linear-gradient(90deg, #10b981, #059669);">
                    </div>
                </div>
                <div style="font-size: 13px; color: var(--gray-700);">
                    ‚úÖ Immunization Records Current<br>
                    ‚úÖ Emergency Contacts Verified<br>
                    ‚ö†Ô∏è 2 enrollment forms pending
                </div>
            </div>

            <!-- Insurance -->
            <div style="border: 1px solid var(--gray-200); border-radius: 8px; padding: 16px;">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px;">
                    <h3 style="font-size: 16px; font-weight: 600; color: var(--gray-900);">‚úÖ INSURANCE</h3>
                    <div style="display: flex; align-items: center; gap: 8px;">
                        <span style="font-size: 14px; color: var(--gray-600);">8/8 Complete</span>
                        <span style="font-size: 18px; font-weight: 700; color: #10b981;">100%</span>
                    </div>
                </div>
                <div
                    style="width: 100%; height: 8px; background: var(--gray-200); border-radius: 4px; overflow: hidden; margin-bottom: 12px;">
                    <div style="width: 100%; height: 100%; background: linear-gradient(90deg, #10b981, #059669);">
                    </div>
                </div>
                <div style="font-size: 13px; color: var(--gray-700);">
                    ‚úÖ General Liability - Current<br>
                    ‚úÖ Workers Comp - Current<br>
                    ‚úÖ Vehicle Insurance - Current
                </div>
            </div>
        </div>

        <div class="modal-footer" style="margin-top: 24px;">
            <button type="button" class="btn btn-secondary" onclick="closeModal('inspection-readiness')">Close</button>
            <button type="button" class="btn" style="background: var(--gray-700); color: white;">üñ®Ô∏è Print
                Report</button>
            <button type="button" class="btn btn-primary">üìß Email Report</button>
        </div>
    </div>
</div>

<!-- New Incident Modal -->
<div id="new-incident" class="modal">
    <div class="modal-content" style="max-width: 700px;">
        <div class="modal-header">
            <h2 class="modal-title">Log New Incident üö®</h2>
        </div>
        <form id="new-incident-form" onsubmit="createIncident(event)">
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 16px;">
                <div class="form-group">
                    <label class="form-label">Child Name</label>
                    <input id="incident-child-name" type="text" class="form-input" placeholder="Select child..."
                        required>
                </div>
                <div class="form-group">
                    <label class="form-label">Incident Type</label>
                    <select id="incident-type" class="form-input" required>
                        <option value="injury">Injury</option>
                        <option value="illness">Illness</option>
                        <option value="behavior">Behavior</option>
                        <option value="other">Other</option>
                    </select>
                </div>
            </div>
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 16px;">
                <div class="form-group">
                    <label class="form-label">Date</label>
                    <input id="incident-date" type="date" class="form-input" required>
                </div>
                <div class="form-group">
                    <label class="form-label">Time</label>
                    <input id="incident-time" type="time" class="form-input" required>
                </div>
            </div>
            <div class="form-group">
                <label class="form-label">Location</label>
                <select id="incident-location" class="form-input" required>
                    <option>Playground</option>
                    <option>Classroom</option>
                    <option>Bathroom</option>
                    <option>Cafeteria</option>
                    <option>Hallway</option>
                    <option>Other</option>
                </select>
            </div>
            <div class="form-group">
                <label class="form-label">Description of Incident</label>
                <textarea id="incident-description" class="form-input" rows="3"
                    placeholder="Describe what happened in detail..." required></textarea>
            </div>
            <div class="form-group">
                <label class="form-label">First Aid/Action Taken</label>
                <textarea id="incident-action" class="form-input" rows="2"
                    placeholder="Band-Aid applied, ice pack provided, etc..." required></textarea>
            </div>
            <div class="form-group">
                <label class="form-label">Staff Member(s) Present</label>
                <input id="incident-staff" type="text" class="form-input" placeholder="Sarah Johnson, Michael Chen"
                    required>
            </div>
            <div class="form-group">
                <label style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
                    <input id="incident-notify-parent" type="checkbox" checked>
                    <span class="form-label" style="margin: 0;">Send automatic notification to parent</span>
                </label>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" onclick="closeModal('new-incident')">Cancel</button>
                <button id="new-incident-btn" type="submit" class="btn btn-primary">Save & Notify Parent</button>
            </div>
        </form>
    </div>
</div>

<!-- Audit Report Modal -->
<div id="audit-report" class="modal">
    <div class="modal-content" style="max-width: 800px; max-height: 90vh;">
        <div class="modal-header">
            <h2 class="modal-title">Generate Audit Report üìÑ</h2>
            <p style="font-size: 14px; color: var(--gray-700); margin-top: 8px;">Comprehensive compliance package
                for Texas DFPS inspections</p>
        </div>

        <div
            style="background: linear-gradient(135deg, rgba(102, 126, 234, 0.1), rgba(118, 75, 162, 0.1)); padding: 20px; border-radius: 12px; margin-bottom: 24px;">
            <div style="display: flex; align-items: center; gap: 16px; margin-bottom: 16px;">
                <div style="font-size: 48px;">‚úÖ</div>
                <div>
                    <h3 style="font-size: 18px; font-weight: 600; margin-bottom: 4px;">Audit-Ready Status</h3>
                    <p style="font-size: 14px; color: var(--gray-700);">Your facility is 94% compliant with all
                        Texas minimum standards</p>
                </div>
            </div>
            <div class="progress-bar" style="margin-bottom: 8px;">
                <div class="progress-fill" style="width: 94%;"></div>
            </div>
            <p style="font-size: 13px; color: var(--gray-700);">1 item needs attention before 100% compliance</p>
        </div>

        <div style="max-height: 400px; overflow-y: auto; margin-bottom: 24px;">
            <h3 style="font-size: 16px; font-weight: 600; margin-bottom: 16px;">Report Will Include:</h3>

            <div style="display: flex; flex-direction: column; gap: 12px;">
                <div
                    style="display: flex; align-items: start; gap: 12px; padding: 12px; background: var(--gray-50); border-radius: 8px;">
                    <span style="color: var(--success); font-size: 20px;">‚úì</span>
                    <div style="flex: 1;">
                        <strong style="font-size: 14px;">A. Required Postings</strong>
                        <div style="font-size: 13px; color: var(--gray-700); margin-top: 4px;">License, inspection
                            reports, evacuation diagrams, emergency contacts, employee list</div>
                    </div>
                    <span class="badge badge-complete">Complete</span>
                </div>

                <div
                    style="display: flex; align-items: start; gap: 12px; padding: 12px; background: var(--gray-50); border-radius: 8px;">
                    <span style="color: var(--success); font-size: 20px;">‚úì</span>
                    <div style="flex: 1;">
                        <strong style="font-size: 14px;">B. Administration & Records</strong>
                        <div style="font-size: 13px; color: var(--gray-700); margin-top: 4px;">Parent handbooks,
                            admission forms, immunization records, attendance logs, incident reports</div>
                    </div>
                    <span class="badge badge-complete">Complete</span>
                </div>

                <div
                    style="display: flex; align-items: start; gap: 12px; padding: 12px; background: var(--gray-50); border-radius: 8px;">
                    <span style="color: var(--warning); font-size: 20px;">‚ö†</span>
                    <div style="flex: 1;">
                        <strong style="font-size: 14px;">C. Personnel & Training</strong>
                        <div style="font-size: 13px; color: var(--gray-700); margin-top: 4px;">Director
                            qualifications, staff orientation, pre-service training, CPR/First Aid certs, annual
                            training hours</div>
                    </div>
                    <span class="badge badge-pending">1 pending</span>
                </div>

                <div
                    style="display: flex; align-items: start; gap: 12px; padding: 12px; background: var(--gray-50); border-radius: 8px;">
                    <span style="color: var(--success); font-size: 20px;">‚úì</span>
                    <div style="flex: 1;">
                        <strong style="font-size: 14px;">D. Health & Safety</strong>
                        <div style="font-size: 13px; color: var(--gray-700); margin-top: 4px;">Child/staff ratios,
                            supervision logs, hand hygiene, medication records</div>
                    </div>
                    <span class="badge badge-complete">Complete</span>
                </div>

                <div
                    style="display: flex; align-items: start; gap: 12px; padding: 12px; background: var(--gray-50); border-radius: 8px;">
                    <span style="color: var(--success); font-size: 20px;">‚úì</span>
                    <div style="flex: 1;">
                        <strong style="font-size: 14px;">E. Facility Compliance</strong>
                        <div style="font-size: 13px; color: var(--gray-700); margin-top: 4px;">Fire inspection
                            reports, emergency drills, playground inspections, sanitation records</div>
                    </div>
                    <span class="badge badge-complete">Complete</span>
                </div>

                <div
                    style="display: flex; align-items: start; gap: 12px; padding: 12px; background: var(--gray-50); border-radius: 8px;">
                    <span style="color: var(--success); font-size: 20px;">‚úì</span>
                    <div style="flex: 1;">
                        <strong style="font-size: 14px;">F. Incident & Illness Documentation</strong>
                        <div style="font-size: 13px; color: var(--gray-700); margin-top: 4px;">Last 3 months of
                            incident reports (8 total), all parent signatures obtained</div>
                    </div>
                    <span class="badge badge-complete">Complete</span>
                </div>

                <div
                    style="display: flex; align-items: start; gap: 12px; padding: 12px; background: var(--gray-50); border-radius: 8px;">
                    <span style="color: var(--success); font-size: 20px;">‚úì</span>
                    <div style="flex: 1;">
                        <strong style="font-size: 14px;">G. Medication Administration Records</strong>
                        <div style="font-size: 13px; color: var(--gray-700); margin-top: 4px;">Parent
                            authorizations, original containers, administration logs with dual signatures, secure
                            storage</div>
                    </div>
                    <span class="badge badge-complete">Complete</span>
                </div>
            </div>
        </div>

        <div style="border-top: 1px solid var(--gray-200); padding-top: 20px;">
            <h3 style="font-size: 14px; font-weight: 600; margin-bottom: 12px;">Export Options:</h3>
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-bottom: 20px;">
                <label
                    style="display: flex; align-items: center; gap: 8px; padding: 12px; border: 2px solid var(--gray-200); border-radius: 8px; cursor: pointer;">
                    <input type="radio" name="export-format" checked>
                    <div>
                        <div style="font-size: 14px; font-weight: 600;">PDF Package</div>
                        <div style="font-size: 12px; color: var(--gray-700);">Print or email to inspector</div>
                    </div>
                </label>
                <label
                    style="display: flex; align-items: center; gap: 8px; padding: 12px; border: 2px solid var(--gray-200); border-radius: 8px; cursor: pointer;">
                    <input type="radio" name="export-format">
                    <div>
                        <div style="font-size: 14px; font-weight: 600;">Digital Link</div>
                        <div style="font-size: 12px; color: var(--gray-700);">Share secure online link</div>
                    </div>
                </label>
            </div>
        </div>

        <div class="modal-footer">
            <button type="button" class="btn btn-secondary" onclick="closeModal('audit-report')">Cancel</button>
            <button type="button" class="btn btn-primary" onclick="generateReport()">Generate Report (5
                seconds)</button>
        </div>
    </div>
</div>

<!-- Add Staff Modal -->
<div id="add-staff" class="modal">
    <div class="modal-content">
        <div class="modal-header">
            <h2 class="modal-title">Add New Staff Member</h2>
        </div>
        <form id="add-staff-form" onsubmit="addStaff(event)">
            <div class="form-group">
                <label class="form-label">Full Name</label>
                <input id="staff-name" type="text" class="form-input" placeholder="John Doe" required>
            </div>
            <div class="form-group">
                <label class="form-label">Role</label>
                <input id="staff-role" type="text" class="form-input" placeholder="Teacher" required>
            </div>
            <div class="form-group">
                <label class="form-label">Email</label>
                <input id="staff-email" type="email" class="form-input" placeholder="john@example.com" required>
            </div>
            <div class="form-group">
                <label class="form-label">Hire Date</label>
                <input id="staff-hire-date" type="date" class="form-input" required>
            </div>

            <!-- Certification Section -->
            <div style="margin-top: 24px; padding-top: 20px; border-top: 1px solid var(--gray-200);">
                <h3 style="font-size: 16px; font-weight: 600; margin-bottom: 16px; color: var(--gray-800);">üìã
                    Certifications & Credentials</h3>

                <!-- CDA Credential -->
                <div class="form-group">
                    <label class="form-label">
                        <input type="checkbox" id="staff-has-cda" onchange="toggleCertificationFields('cda')">
                        Child Development Associate (CDA) Credential
                    </label>
                    <div id="cda-fields" style="display: none; margin-top: 12px; padding-left: 24px;">
                        <div class="form-group">
                            <label class="form-label">CDA Number</label>
                            <input id="staff-cda-number" type="text" class="form-input" placeholder="CDA12345678">
                        </div>
                        <div class="form-group">
                            <label class="form-label">CDA Expiration Date</label>
                            <input id="staff-cda-expiration" type="date" class="form-input">
                        </div>
                    </div>
                </div>

                <!-- Teaching Certificate -->
                <div class="form-group">
                    <label class="form-label">
                        <input type="checkbox" id="staff-has-teaching-cert"
                            onchange="toggleCertificationFields('teaching')">
                        Texas Teaching Certificate
                    </label>
                    <div id="teaching-fields" style="display: none; margin-top: 12px; padding-left: 24px;">
                        <div class="form-group">
                            <label class="form-label">Certificate Number</label>
                            <input id="staff-teaching-number" type="text" class="form-input" placeholder="12345678">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Certificate Type</label>
                            <select id="staff-teaching-type" class="form-input">
                                <option value="">Select type...</option>
                                <option value="standard">Standard</option>
                                <option value="provisional">Provisional</option>
                                <option value="probationary">Probationary</option>
                                <option value="emergency">Emergency</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Expiration Date</label>
                            <input id="staff-teaching-expiration" type="date" class="form-input">
                        </div>
                    </div>
                </div>

                <!-- Food Handler Certificate -->
                <div class="form-group">
                    <label class="form-label">
                        <input type="checkbox" id="staff-has-food-handler" onchange="toggleCertificationFields('food')">
                        Texas Food Handler Certificate
                    </label>
                    <div id="food-fields" style="display: none; margin-top: 12px; padding-left: 24px;">
                        <div class="form-group">
                            <label class="form-label">Certificate Number</label>
                            <input id="staff-food-number" type="text" class="form-input" placeholder="FH123456">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Expiration Date</label>
                            <input id="staff-food-expiration" type="date" class="form-input">
                        </div>
                        <small class="form-help">Texas requires food handler certification for staff preparing meals
                            (renewal every 2 years)</small>
                    </div>
                </div>

                <!-- CPR/First Aid -->
                <div class="form-group">
                    <label class="form-label">
                        <input type="checkbox" id="staff-has-cpr" onchange="toggleCertificationFields('cpr')">
                        CPR & First Aid Certification
                    </label>
                    <div id="cpr-fields" style="display: none; margin-top: 12px; padding-left: 24px;">
                        <div class="form-group">
                            <label class="form-label">Certification Type</label>
                            <select id="staff-cpr-type" class="form-input">
                                <option value="">Select type...</option>
                                <option value="pediatric">Pediatric CPR/First Aid</option>
                                <option value="infant">Infant CPR</option>
                                <option value="adult-child">Adult & Child CPR</option>
                                <option value="comprehensive">Comprehensive (All Ages)</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Certification Provider</label>
                            <input id="staff-cpr-provider" type="text" class="form-input"
                                placeholder="American Red Cross, AHA, etc.">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Expiration Date</label>
                            <input id="staff-cpr-expiration" type="date" class="form-input">
                        </div>
                        <small class="form-help">Texas requires at least one staff with current certification on
                            premises at all times</small>
                    </div>
                </div>
            </div>

            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" onclick="closeModal('add-staff')">Cancel</button>
                <button id="add-staff-btn" type="submit" class="btn btn-primary">Add Staff Member</button>
            </div>
        </form>
    </div>
</div>

<!-- Staff Details Modal -->
<div id="staff-details" class="modal">
    <div class="modal-content" style="max-width: 700px;">
        <div class="modal-header">
            <h2 class="modal-title">Staff Member Details</h2>
        </div>
        <div id="staff-details-content" style="padding: 20px 0;">
            <!-- Populated dynamically -->
        </div>
        <div class="modal-footer">
            <button type="button" class="btn btn-secondary" onclick="closeModal('staff-details')">Close</button>
            <button type="button" class="btn btn-primary" onclick="editStaffFromDetails()">Edit</button>
            <button type="button" class="btn btn-danger" onclick="confirmDeleteStaff()">Delete</button>
        </div>
    </div>
</div>

<!-- Edit Staff Modal -->
<div id="edit-staff" class="modal">
    <div class="modal-content" style="max-width: 600px; max-height: 90vh; overflow-y: auto;">
        <div class="modal-header">
            <h2 class="modal-title">Edit Staff Member</h2>
        </div>
        <form id="edit-staff-form" onsubmit="updateStaff(event)">
            <input type="hidden" id="edit-staff-id">
            <div class="form-group">
                <label class="form-label">Full Name</label>
                <input id="edit-staff-name" type="text" class="form-input" required>
            </div>
            <div class="form-group">
                <label class="form-label">Role</label>
                <input id="edit-staff-role" type="text" class="form-input" required>
            </div>
            <div class="form-group">
                <label class="form-label">Email</label>
                <input id="edit-staff-email" type="email" class="form-input" required>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" onclick="closeModal('edit-staff')">Cancel</button>
                <button id="update-staff-btn" type="submit" class="btn btn-primary">Save Changes</button>
            </div>
        </form>
    </div>
</div>

<!-- Import Staff CSV Modal -->
<div id="import-staff-csv" class="modal">
    <div class="modal-content" style="max-width: 900px;">
        <div class="modal-header">
            <h2 class="modal-title">Import Staff from CSV</h2>
        </div>
        <div style="padding: 20px 0;">
            <!-- Step 1: Upload File -->
            <div id="csv-upload-step" class="csv-step">
                <div style="text-align: center; margin-bottom: 24px;">
                    <h3 style="font-size: 16px; font-weight: 600; margin-bottom: 8px;">Step 1: Upload CSV File</h3>
                    <p style="font-size: 14px; color: var(--gray-700);">Upload a CSV file with staff information</p>
                </div>

                <!-- Download Template Button -->
                <div style="text-align: center; margin-bottom: 16px;">
                    <a href="/templates/staff-import-template.csv" download class="btn btn-secondary">
                        üì• Download CSV Template
                    </a>
                </div>

                <!-- Drag-Drop Zone -->
                <div id="csv-drop-zone" class="drop-zone" ondragover="handleCSVDragOver(event)"
                    ondrop="handleCSVDrop(event, 'staff')" onclick="document.getElementById('csv-file-input').click()">
                    <div class="drop-zone-icon">üìÑ</div>
                    <p class="drop-zone-text">Drag and drop your CSV file here</p>
                    <p class="drop-zone-subtext">or click to browse</p>
                    <p style="font-size: 12px; color: var(--gray-600); margin-top: 8px;">CSV files only, max 5MB</p>
                    <input type="file" id="csv-file-input" accept=".csv" style="display: none;"
                        onchange="handleCSVFileSelect(event, 'staff')">
                </div>

                <!-- File Preview (shown after selection) -->
                <div id="csv-file-preview"
                    style="display: none; margin-top: 16px; padding: 16px; background: var(--gray-50); border-radius: 8px;">
                    <div style="display: flex; justify-content: space-between; align-items: center;">
                        <div style="display: flex; align-items: center; gap: 12px;">
                            <span style="font-size: 32px;">üìÑ</span>
                            <div>
                                <div id="csv-filename" style="font-weight: 600;"></div>
                                <div id="csv-filesize" style="font-size: 13px; color: var(--gray-700);"></div>
                            </div>
                        </div>
                        <button type="button" class="btn btn-secondary" onclick="removeCSVFile()">Remove</button>
                    </div>
                </div>
            </div>

            <!-- Step 2: Preview & Validate -->
            <div id="csv-preview-step" class="csv-step" style="display: none;">
                <div style="text-align: center; margin-bottom: 24px;">
                    <h3 style="font-size: 16px; font-weight: 600; margin-bottom: 8px;">Step 2: Review Data</h3>
                    <p style="font-size: 14px; color: var(--gray-700);">Verify the imported data before confirming
                    </p>
                </div>

                <!-- Summary Stats -->
                <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 16px; margin-bottom: 24px;">
                    <div style="padding: 16px; background: var(--gray-50); border-radius: 8px; text-align: center;">
                        <div id="csv-total-rows" style="font-size: 24px; font-weight: 700; color: var(--gray-900);">
                            0</div>
                        <div style="font-size: 13px; color: var(--gray-700);">Total Rows</div>
                    </div>
                    <div
                        style="padding: 16px; background: var(--success-light); border-radius: 8px; text-align: center;">
                        <div id="csv-valid-rows" style="font-size: 24px; font-weight: 700; color: var(--success);">0
                        </div>
                        <div style="font-size: 13px; color: var(--success);">Valid</div>
                    </div>
                    <div
                        style="padding: 16px; background: var(--danger-light); border-radius: 8px; text-align: center;">
                        <div id="csv-error-rows" style="font-size: 24px; font-weight: 700; color: var(--danger);">0
                        </div>
                        <div style="font-size: 13px; color: var(--danger);">Errors</div>
                    </div>
                </div>

                <!-- Preview Table -->
                <div style="max-height: 400px; overflow: auto; border: 1px solid var(--gray-300); border-radius: 8px;">
                    <table class="table">
                        <thead id="csv-preview-header">
                            <!-- Dynamic headers -->
                        </thead>
                        <tbody id="csv-preview-body">
                            <!-- Dynamic rows -->
                        </tbody>
                    </table>
                </div>

                <!-- Error Messages -->
                <div id="csv-errors" style="margin-top: 16px; display: none;">
                    <h4 style="font-size: 14px; font-weight: 600; color: var(--danger); margin-bottom: 8px;">
                        ‚ö†Ô∏è Validation Errors
                    </h4>
                    <div id="csv-error-list"
                        style="max-height: 150px; overflow: auto; padding: 12px; background: var(--danger-light); border-radius: 8px; font-size: 13px;">
                        <!-- Dynamic error messages -->
                    </div>
                </div>
            </div>

            <!-- Step 3: Import Progress -->
            <div id="csv-import-step" class="csv-step" style="display: none;">
                <div style="text-align: center;">
                    <div class="spinner" style="margin: 0 auto 16px;"></div>
                    <h3 style="font-size: 16px; font-weight: 600; margin-bottom: 8px;">Importing Staff...</h3>
                    <p id="csv-import-status" style="font-size: 14px; color: var(--gray-700);">Processing 0 of 0
                        rows</p>
                    <div class="progress" style="margin-top: 16px;">
                        <div id="csv-import-progress" class="progress-fill" style="width: 0%;"></div>
                    </div>
                </div>
            </div>

            <!-- Step 4: Results -->
            <div id="csv-results-step" class="csv-step" style="display: none;">
                <div style="text-align: center; margin-bottom: 24px;">
                    <div id="csv-results-icon" style="font-size: 64px; margin-bottom: 16px;">‚úÖ</div>
                    <h3 id="csv-results-title" style="font-size: 18px; font-weight: 600; margin-bottom: 8px;">Import
                        Complete!</h3>
                    <p id="csv-results-message" style="font-size: 14px; color: var(--gray-700);"></p>
                </div>

                <!-- Results Summary -->
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 16px; margin-bottom: 16px;">
                    <div
                        style="padding: 20px; background: var(--success-light); border-radius: 8px; text-align: center;">
                        <div id="csv-success-count" style="font-size: 32px; font-weight: 700; color: var(--success);">0
                        </div>
                        <div style="font-size: 14px; color: var(--success); font-weight: 600;">Successfully Imported
                        </div>
                    </div>
                    <div
                        style="padding: 20px; background: var(--danger-light); border-radius: 8px; text-align: center;">
                        <div id="csv-failure-count" style="font-size: 32px; font-weight: 700; color: var(--danger);">0
                        </div>
                        <div style="font-size: 14px; color: var(--danger); font-weight: 600;">Failed</div>
                    </div>
                </div>

                <!-- Failed Rows Detail -->
                <div id="csv-failed-rows" style="display: none;">
                    <h4 style="font-size: 14px; font-weight: 600; margin-bottom: 12px;">Failed Rows:</h4>
                    <div id="csv-failed-list"
                        style="max-height: 200px; overflow: auto; padding: 12px; background: var(--gray-50); border-radius: 8px; font-size: 13px;">
                        <!-- Failed rows list -->
                    </div>
                    <div style="margin-top: 12px;">
                        <button type="button" class="btn btn-secondary" onclick="downloadCSVErrorReport()">
                            üì• Download Error Report
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <div class="modal-footer">
            <button type="button" id="csv-back-btn" class="btn btn-secondary" onclick="csvGoBack()"
                style="display: none;">
                ‚Üê Back
            </button>
            <button type="button" class="btn btn-secondary" onclick="closeCSVImport()">
                <span id="csv-cancel-text">Cancel</span>
            </button>
            <button type="button" id="csv-next-btn" class="btn btn-primary" onclick="csvNextStep()" disabled>
                Next ‚Üí
            </button>
            <button type="button" id="csv-import-btn" class="btn btn-primary" onclick="executeCSVImport('staff')"
                style="display: none;">
                Confirm Import
            </button>
            <button type="button" id="csv-done-btn" class="btn btn-primary" onclick="closeCSVImport()"
                style="display: none;">
                Done
            </button>
        </div>
    </div>
</div>

<!-- Import Medications CSV Modal -->
<div id="import-medication-csv" class="modal">
    <div class="modal-content" style="max-width: 900px;">
        <div class="modal-header">
            <h2 class="modal-title">Import Medications from CSV</h2>
        </div>
        <div style="padding: 20px 0;">
            <!-- Step 1: Upload File -->
            <div id="csv-med-upload-step" class="csv-step">
                <div style="text-align: center; margin-bottom: 24px;">
                    <h3 style="font-size: 16px; font-weight: 600; margin-bottom: 8px;">Step 1: Upload CSV File</h3>
                    <p style="font-size: 14px; color: var(--gray-700);">Upload a CSV file with medication
                        authorizations</p>
                    <div
                        style="margin-top: 8px; padding: 12px; background: var(--warning-light); border-radius: 8px; border-left: 4px solid var(--warning);">
                        <strong style="color: var(--warning);">‚ö†Ô∏è Texas Compliance:</strong>
                        <span style="font-size: 13px; color: var(--gray-800);"> Maximum 1-year authorization per
                            ¬ß746.2653</span>
                    </div>
                </div>

                <!-- Download Template Button -->
                <div style="text-align: center; margin-bottom: 16px;">
                    <a href="/templates/medications-import-template.csv" download class="btn btn-secondary">
                        üì• Download CSV Template
                    </a>
                </div>

                <!-- Drag-Drop Zone -->
                <div id="csv-med-drop-zone" class="drop-zone" ondragover="handleCSVDragOver(event)"
                    ondrop="handleCSVDrop(event, 'medication')"
                    onclick="document.getElementById('csv-med-file-input').click()">
                    <div class="drop-zone-icon">üìÑ</div>
                    <p class="drop-zone-text">Drag and drop your CSV file here</p>
                    <p class="drop-zone-subtext">or click to browse</p>
                    <p style="font-size: 12px; color: var(--gray-600); margin-top: 8px;">CSV files only, max 5MB</p>
                    <input type="file" id="csv-med-file-input" accept=".csv" style="display: none;"
                        onchange="handleCSVFileSelect(event, 'medication')">
                </div>

                <!-- File Preview -->
                <div id="csv-med-file-preview"
                    style="display: none; margin-top: 16px; padding: 16px; background: var(--gray-50); border-radius: 8px;">
                    <div style="display: flex; justify-content: space-between; align-items: center;">
                        <div style="display: flex; align-items: center; gap: 12px;">
                            <span style="font-size: 32px;">üìÑ</span>
                            <div>
                                <div id="csv-med-filename" style="font-weight: 600;"></div>
                                <div id="csv-med-filesize" style="font-size: 13px; color: var(--gray-700);"></div>
                            </div>
                        </div>
                        <button type="button" class="btn btn-secondary" onclick="removeCSVMedFile()">Remove</button>
                    </div>
                </div>
            </div>

            <!-- Preview/Results steps similar to staff import -->
            <div id="csv-med-preview-step" class="csv-step" style="display: none;">
                <div style="text-align: center; margin-bottom: 24px;">
                    <h3 style="font-size: 16px; font-weight: 600; margin-bottom: 8px;">Step 2: Review Medication
                        Data</h3>
                    <p style="font-size: 14px; color: var(--gray-700);">Verify authorizations before importing</p>
                </div>

                <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 16px; margin-bottom: 24px;">
                    <div style="padding: 16px; background: var(--gray-50); border-radius: 8px; text-align: center;">
                        <div id="csv-med-total-rows" style="font-size: 24px; font-weight: 700; color: var(--gray-900);">
                            0</div>
                        <div style="font-size: 13px; color: var(--gray-700);">Total Rows</div>
                    </div>
                    <div
                        style="padding: 16px; background: var(--success-light); border-radius: 8px; text-align: center;">
                        <div id="csv-med-valid-rows" style="font-size: 24px; font-weight: 700; color: var(--success);">0
                        </div>
                        <div style="font-size: 13px; color: var(--success);">Valid</div>
                    </div>
                    <div
                        style="padding: 16px; background: var(--danger-light); border-radius: 8px; text-align: center;">
                        <div id="csv-med-error-rows" style="font-size: 24px; font-weight: 700; color: var(--danger);">0
                        </div>
                        <div style="font-size: 13px; color: var(--danger);">Errors</div>
                    </div>
                </div>

                <div style="max-height: 400px; overflow: auto; border: 1px solid var(--gray-300); border-radius: 8px;">
                    <table class="table">
                        <thead id="csv-med-preview-header"></thead>
                        <tbody id="csv-med-preview-body"></tbody>
                    </table>
                </div>

                <div id="csv-med-errors" style="margin-top: 16px; display: none;">
                    <h4 style="font-size: 14px; font-weight: 600; color: var(--danger); margin-bottom: 8px;">
                        ‚ö†Ô∏è Validation Errors
                    </h4>
                    <div id="csv-med-error-list"
                        style="max-height: 150px; overflow: auto; padding: 12px; background: var(--danger-light); border-radius: 8px; font-size: 13px;">
                    </div>
                </div>
            </div>
        </div>

        <div class="modal-footer">
            <button type="button" id="csv-med-back-btn" class="btn btn-secondary" onclick="csvMedGoBack()"
                style="display: none;">‚Üê Back</button>
            <button type="button" class="btn btn-secondary" onclick="closeCSVMedImport()">
                <span id="csv-med-cancel-text">Cancel</span>
            </button>
            <button type="button" id="csv-med-next-btn" class="btn btn-primary" onclick="csvMedNextStep()" disabled>Next
                ‚Üí</button>
            <button type="button" id="csv-med-import-btn" class="btn btn-primary"
                onclick="executeCSVImport('medication')" style="display: none;">Confirm Import</button>
        </div>
    </div>
</div>

<!-- Incident Details Modal -->
<div id="incident-details" class="modal">
    <div class="modal-content" style="max-width: 800px;">
        <div class="modal-header">
            <h2 class="modal-title">Incident Report Details</h2>
        </div>
        <div id="incident-details-content" style="padding: 20px 0;">
            <!-- Populated dynamically -->
        </div>
        <div class="modal-footer">
            <button type="button" class="btn btn-secondary" onclick="closeModal('incident-details')">Close</button>
            <button type="button" class="btn btn-primary" onclick="printIncidentReport()">Print Report</button>
            <button type="button" class="btn btn-danger" onclick="confirmDeleteIncident()">Delete</button>
        </div>
    </div>
</div>

<!-- Medication Details Modal -->
<div id="medication-details" class="modal">
    <div class="modal-content" style="max-width: 700px;">
        <div class="modal-header">
            <h2 class="modal-title">Medication Authorization Details</h2>
        </div>
        <div id="medication-details-content" style="padding: 20px 0;">
            <!-- Populated dynamically -->
        </div>
        <div class="modal-footer">
            <button type="button" class="btn btn-secondary" onclick="closeModal('medication-details')">Close</button>
            <button type="button" class="btn btn-primary" onclick="administerFromDetails()">Administer Now</button>
            <button type="button" class="btn btn-danger" onclick="confirmDeleteMedication()">Delete</button>
        </div>
    </div>
</div>

<!-- Medication Administration Modal -->
<div id="administer-medication" class="modal">
    <div class="modal-content" style="max-width: 600px;">
        <div class="modal-header">
            <h2 class="modal-title">Administer Medication</h2>
            <p style="font-size: 14px; color: var(--danger); margin-top: 8px;">‚ö†Ô∏è Dual-Staff Verification Required
                per Texas ¬ß744.2651</p>
        </div>
        <form id="administer-medication-form" onsubmit="recordMedicationAdministration(event)">
            <input type="hidden" id="admin-med-id">

            <div id="admin-med-info"
                style="background: var(--gray-50); padding: 16px; border-radius: 8px; margin-bottom: 20px;">
                <!-- Medication info populated dynamically -->
            </div>

            <div class="form-group">
                <label class="form-label">Administered By (First Staff Member)</label>
                <input id="admin-by-staff1" type="text" class="form-input" placeholder="Your name" required>
            </div>

            <div class="form-group">
                <label class="form-label">Verified By (Second Staff Member) *Required*</label>
                <input id="admin-by-staff2" type="text" class="form-input" placeholder="Witness staff name" required>
                <small class="form-help">Texas law requires two staff members for medication verification</small>
            </div>

            <div class="form-group">
                <label class="form-label">Dosage Given</label>
                <input id="admin-dosage-given" type="text" class="form-input" placeholder="e.g., 5 mL" required>
            </div>

            <div class="form-group">
                <label class="form-label">Time Administered</label>
                <input id="admin-time" type="time" class="form-input" required>
            </div>

            <div class="form-group">
                <label class="form-label">
                    üì∑ Verification Photo
                    <span style="font-size: 12px; color: var(--gray-600); font-weight: 400;">(Recommended per Texas
                        ¬ß746.2655)</span>
                </label>
                <div id="med-photo-upload-zone" class="drop-zone"
                    style="border: 2px dashed var(--gray-300); border-radius: 8px; padding: 24px; text-align: center; cursor: pointer; transition: all 0.3s ease;"
                    ondragover="handleMedPhotoDragOver(event)" ondrop="handleMedPhotoDrop(event)"
                    onclick="document.getElementById('med-photo-input').click()">
                    <div style="font-size: 48px; margin-bottom: 12px;">üì∑</div>
                    <div style="font-size: 14px; color: var(--gray-700); font-weight: 500; margin-bottom: 4px;">
                        Click to upload or drag & drop
                    </div>
                    <div style="font-size: 12px; color: var(--gray-600);">
                        Photo of medication container and child (if parent consents)
                    </div>
                    <div style="font-size: 11px; color: var(--gray-500); margin-top: 8px;">
                        PNG, JPG up to 10MB
                    </div>
                </div>
                <input type="file" id="med-photo-input" accept="image/*" capture="environment" style="display: none;"
                    onchange="handleMedPhotoSelect(event)">

                <div id="med-photo-preview"
                    style="display: none; margin-top: 12px; padding: 12px; background: var(--gray-50); border-radius: 8px;">
                    <div style="display: flex; align-items: center; gap: 12px;">
                        <img id="med-photo-thumbnail" src="" alt="Preview"
                            style="width: 80px; height: 80px; object-fit: cover; border-radius: 8px; border: 2px solid var(--gray-300);">
                        <div style="flex: 1;">
                            <div style="font-size: 13px; font-weight: 600; color: var(--gray-800);"
                                id="med-photo-filename"></div>
                            <div style="font-size: 12px; color: var(--gray-600); margin-top: 2px;"
                                id="med-photo-filesize"></div>
                            <div style="font-size: 11px; color: var(--success); margin-top: 4px;">‚úì Ready to upload
                            </div>
                        </div>
                        <button type="button" class="btn-icon-small" onclick="removeMedPhoto()"
                            style="background: var(--danger); color: white; border: none; padding: 6px 12px; border-radius: 6px; cursor: pointer; font-size: 12px;">Remove</button>
                    </div>
                </div>
                <small class="form-help">Documentation helps verify proper administration and protects staff from
                    liability</small>
            </div>

            <div class="form-group">
                <label class="form-label">Notes (optional)</label>
                <textarea id="admin-notes" class="form-input" rows="3"
                    placeholder="Any observations or notes..."></textarea>
            </div>

            <div class="modal-footer">
                <button type="button" class="btn btn-secondary"
                    onclick="closeModal('administer-medication')">Cancel</button>
                <button id="admin-medication-btn" type="submit" class="btn btn-primary">Record
                    Administration</button>
            </div>
        </form>
    </div>
</div>

<!-- Document Details Modal -->
<div id="document-details" class="modal">
    <div class="modal-content" style="max-width: 700px;">
        <div class="modal-header">
            <h2 class="modal-title">Document Details</h2>
        </div>
        <div id="document-details-content" style="padding: 20px 0;">
            <!-- Populated dynamically -->
        </div>
        <div class="modal-footer">
            <button type="button" class="btn btn-secondary" onclick="closeModal('document-details')">Close</button>
            <button type="button" class="btn btn-primary" onclick="downloadDocumentFromDetails()">Download</button>
            <button type="button" class="btn btn-danger" onclick="confirmDeleteDocument()">Delete</button>
        </div>
    </div>
</div>

<!-- Delete Confirmation Modal -->
<div id="delete-confirm" class="modal">
    <div class="modal-content" style="max-width: 500px;">
        <div class="modal-header">
            <h2 class="modal-title">‚ö†Ô∏è Confirm Deletion</h2>
        </div>
        <div style="padding: 20px 0;">
            <p id="delete-confirm-message" style="font-size: 16px; color: var(--gray-800); margin-bottom: 20px;">
            </p>
            <div style="background: #fee; padding: 16px; border-radius: 8px; border-left: 4px solid var(--danger);">
                <strong style="color: var(--danger);">Warning:</strong>
                <p style="margin-top: 8px; font-size: 14px; color: var(--gray-700);">This action cannot be undone.
                    All associated data will be permanently deleted.</p>
            </div>
        </div>
        <div class="modal-footer">
            <button type="button" class="btn btn-secondary" onclick="closeModal('delete-confirm')">Cancel</button>
            <button id="confirm-delete-btn" type="button" class="btn btn-danger" onclick="executeDelete()">Yes,
                Delete Permanently</button>
        </div>
    </div>
</div>

<!-- Training Completion Modal -->
<div id="complete-training" class="modal">
    <div class="modal-content" style="max-width: 600px;">
        <div class="modal-header">
            <h2 class="modal-title">üìö Complete Training Module</h2>
        </div>
        <form id="training-completion-form" onsubmit="submitTrainingCompletion(event)">
            <div style="padding: 0 20px 20px 20px;">
                <div
                    style="background: var(--primary-50); padding: 16px; border-radius: 8px; margin-bottom: 20px; border-left: 4px solid var(--primary);">
                    <h3 id="training-module-title" style="font-size: 16px; font-weight: 600; margin-bottom: 8px;">
                    </h3>
                    <p id="training-module-description" style="font-size: 14px; color: var(--gray-700);"></p>
                </div>

                <div class="form-group">
                    <label class="form-label" for="training-staff-select">Select Staff Member *</label>
                    <select id="training-staff-select" class="form-input" required>
                        <option value="">-- Choose a staff member --</option>
                    </select>
                    <small class="form-hint">Select the staff member who completed this training module</small>
                </div>

                <div class="form-group">
                    <label class="form-label" for="training-completion-date">Completion Date *</label>
                    <input id="training-completion-date" type="date" class="form-input" required>
                </div>

                <div class="form-group">
                    <label class="form-label" for="training-hours">Training Hours *</label>
                    <input id="training-hours" type="number" class="form-input" min="0.5" max="24" step="0.5"
                        placeholder="e.g., 2.5" required>
                    <small class="form-hint">How many hours did this training take?</small>
                </div>

                <div class="form-group">
                    <label class="form-label" for="training-notes">Notes (optional)</label>
                    <textarea id="training-notes" class="form-input" rows="3"
                        placeholder="Additional notes about the training..."></textarea>
                </div>
            </div>

            <div class="modal-footer">
                <button type="button" class="btn btn-secondary"
                    onclick="closeModal('complete-training')">Cancel</button>
                <button id="submit-training-btn" type="submit" class="btn btn-primary">Mark as Complete</button>
            </div>
        </form>
    </div>
</div>