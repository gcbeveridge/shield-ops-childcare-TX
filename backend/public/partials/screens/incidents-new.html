<!-- =============================================
     INCIDENTS PAGE - CAC DESIGN v2.0
     ============================================= -->

<!-- Page Header -->
<div class="cac-page-header cac-animate-slideDown">
    <div style="display: flex; justify-content: space-between; align-items: center;">
        <div>
            <h1 class="cac-page-title">
                <span class="cac-page-icon">🚨</span>
                Incident Tracking
            </h1>
            <p class="cac-page-subtitle">Texas DFPS-compliant incident reporting • Real-time parent notifications</p>
        </div>
        <div style="display: flex; gap: 12px;">
            <button class="cac-btn cac-btn-secondary" onclick="exportIncidentReport()">
                <span>📊</span> Export Report
            </button>
            <button class="cac-btn cac-btn-primary" onclick="openModal('new-incident')">
                <span>+</span> Report Incident
            </button>
        </div>
    </div>
</div>

<!-- Stats Overview -->
<div class="cac-stats-grid cac-animate-slideUp" style="animation-delay: 0.1s;">
    <div class="cac-stat-card cac-stat-success">
        <div class="cac-stat-icon">✅</div>
        <div class="cac-stat-value" id="incident-free-days">--</div>
        <div class="cac-stat-label">Days Incident-Free</div>
        <div class="cac-stat-trend">Current streak</div>
    </div>
    
    <div class="cac-stat-card cac-stat-info">
        <div class="cac-stat-icon">📋</div>
        <div class="cac-stat-value" id="total-incidents">--</div>
        <div class="cac-stat-label">Total Incidents (30 days)</div>
        <div class="cac-stat-trend">All severity levels</div>
    </div>
    
    <div class="cac-stat-card cac-stat-warning">
        <div class="cac-stat-icon">⚠️</div>
        <div class="cac-stat-value" id="pending-signatures">--</div>
        <div class="cac-stat-label">Pending Parent Signatures</div>
        <div class="cac-stat-trend">Action required</div>
    </div>
    
    <div class="cac-stat-card cac-stat-primary">
        <div class="cac-stat-icon">📈</div>
        <div class="cac-stat-value" id="incident-response-time">--</div>
        <div class="cac-stat-label">Avg Response Time</div>
        <div class="cac-stat-trend">Parent notification</div>
    </div>
</div>

<!-- Quick Filters -->
<div class="cac-card cac-animate-slideUp" style="animation-delay: 0.2s;">
    <div class="cac-filter-bar">
        <div class="cac-filter-group">
            <label>Time Period</label>
            <select id="incident-time-filter" class="cac-select" onchange="filterIncidents()">
                <option value="today">Today</option>
                <option value="week">This Week</option>
                <option value="month" selected>This Month</option>
                <option value="quarter">This Quarter</option>
                <option value="year">This Year</option>
                <option value="all">All Time</option>
            </select>
        </div>
        <div class="cac-filter-group">
            <label>Severity</label>
            <select id="incident-severity-filter" class="cac-select" onchange="filterIncidents()">
                <option value="all">All Severities</option>
                <option value="critical">Critical</option>
                <option value="major">Major</option>
                <option value="moderate">Moderate</option>
                <option value="minor">Minor</option>
            </select>
        </div>
        <div class="cac-filter-group">
            <label>Type</label>
            <select id="incident-type-filter" class="cac-select" onchange="filterIncidents()">
                <option value="all">All Types</option>
                <option value="injury">Injury</option>
                <option value="illness">Illness</option>
                <option value="behavior">Behavior</option>
                <option value="accident">Accident</option>
                <option value="other">Other</option>
            </select>
        </div>
        <div class="cac-filter-group">
            <label>Status</label>
            <select id="incident-status-filter" class="cac-select" onchange="filterIncidents()">
                <option value="all">All Status</option>
                <option value="pending">Pending Signature</option>
                <option value="signed">Signed</option>
                <option value="reviewed">Reviewed</option>
            </select>
        </div>
    </div>
</div>

<!-- Severity Distribution -->
<div class="cac-card cac-animate-slideUp" style="animation-delay: 0.3s;">
    <div class="cac-card-header">
        <h3 class="cac-card-title">
            <span class="cac-card-title-icon">📊</span>
            Incident Distribution (Last 30 Days)
        </h3>
    </div>
    
    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 16px;">
        <div class="cac-severity-card cac-severity-critical">
            <div class="cac-severity-count" id="critical-count">0</div>
            <div class="cac-severity-label">Critical</div>
            <div class="cac-severity-bar">
                <div class="cac-severity-bar-fill" id="critical-bar" style="width: 0%"></div>
            </div>
        </div>
        
        <div class="cac-severity-card cac-severity-major">
            <div class="cac-severity-count" id="major-count">0</div>
            <div class="cac-severity-label">Major</div>
            <div class="cac-severity-bar">
                <div class="cac-severity-bar-fill" id="major-bar" style="width: 0%"></div>
            </div>
        </div>
        
        <div class="cac-severity-card cac-severity-moderate">
            <div class="cac-severity-count" id="moderate-count">0</div>
            <div class="cac-severity-label">Moderate</div>
            <div class="cac-severity-bar">
                <div class="cac-severity-bar-fill" id="moderate-bar" style="width: 0%"></div>
            </div>
        </div>
        
        <div class="cac-severity-card cac-severity-minor">
            <div class="cac-severity-count" id="minor-count">0</div>
            <div class="cac-severity-label">Minor</div>
            <div class="cac-severity-bar">
                <div class="cac-severity-bar-fill" id="minor-bar" style="width: 0%"></div>
            </div>
        </div>
    </div>
</div>

<!-- Incidents Timeline -->
<div class="cac-card cac-animate-slideUp" style="animation-delay: 0.4s;">
    <div class="cac-card-header">
        <h3 class="cac-card-title">
            <span class="cac-card-title-icon">📅</span>
            Incident Timeline
        </h3>
        <div class="cac-card-actions">
            <button class="cac-btn cac-btn-sm cac-btn-secondary" onclick="toggleIncidentView('list')">
                <span>📋</span> List
            </button>
            <button class="cac-btn cac-btn-sm cac-btn-secondary" onclick="toggleIncidentView('timeline')">
                <span>📅</span> Timeline
            </button>
        </div>
    </div>
    
    <!-- Timeline View -->
    <div id="incidents-timeline-view">
        <div id="incidents-timeline" class="cac-timeline">
            <!-- Populated dynamically -->
        </div>
    </div>
    
    <!-- List View -->
    <div id="incidents-list-view" style="display: none;">
        <div class="cac-table-container">
            <table class="cac-table">
                <thead>
                    <tr>
                        <th>Date/Time</th>
                        <th>Child</th>
                        <th>Type</th>
                        <th>Severity</th>
                        <th>Description</th>
                        <th>Reported By</th>
                        <th>Status</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody id="incidents-table-body">
                    <!-- Populated dynamically -->
                </tbody>
            </table>
        </div>
    </div>
    
    <!-- Empty State -->
    <div id="incidents-empty" class="cac-empty-state" style="display: none;">
        <div class="cac-empty-icon">🎉</div>
        <h3>No Incidents Recorded</h3>
        <p>Great job! No incidents match your current filters.</p>
    </div>
</div>

<!-- Required Actions -->
<div id="required-actions-card" class="cac-card cac-animate-slideUp" style="display: none; animation-delay: 0.5s;">
    <div class="cac-card-header">
        <h3 class="cac-card-title">
            <span class="cac-card-title-icon">⚠️</span>
            Required Actions
        </h3>
        <span class="cac-badge cac-badge-warning" id="required-actions-count">0</span>
    </div>
    
    <div id="required-actions-list" class="cac-action-list">
        <!-- Populated dynamically with pending signatures, reviews, etc. -->
    </div>
</div>
